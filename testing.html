<!DOCTYPE html>
<html>
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162707788-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-162707788-1');
</script>
</head>
<title>COVID-19 in Pennsylvania</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>ArcGIS Dashboards</title>
<meta name="description" content>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://js.arcgis.com/3.32/dijit/themes/claro/claro.css" rel="stylesheet" type="text/css">
<link href="https://js.arcgis.com/3.32/esri/css/esri.css" rel="stylesheet" type="text/css">
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
 <script src="jquery.csv.min.js"></script>
 <script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
// load the visualization library from Google and set a listener
google.load("visualization", "1", {packages:["corechart"]});
google.setOnLoadCallback(drawChart);

console.log($.csv);
var ax = $.csv;   // <<< --- this change $.csv for ax !!!

// this has to be a global function
function drawChart() {
   // grab the CSV
   $.get("data/14_day_chart.csv", function(csvString) {
      // transform the CSV string into a 2-dimensional array
      var arrayData = ax.toArrays(csvString, {onParseValue: ax.hooks.castToScalar});

      // this new DataTable object holds all the data
      var data = new google.visualization.arrayToDataTable(arrayData);

      // this view can select a subset of the data at a time
      var view = new google.visualization.DataView(data);
      view.setColumns([0,2,3,5,6]);

     var options = {
        colors: ['#6eeb34', "#7beb47", '#8113e8', "#9c43ef"],
        chart: {
          title: 'New Cases in Past 14 Days',
        },
        width: "100%",
        height: 500,
        vAxes: {  0: {viewWindowMode:'explicit',
                      viewWindow:{
                                  max:6000,
                                  min:0
                                  },
                      gridlines: {color: 'transparent'},
                      },
                  1: {viewWindowMode:'explicit',
                      viewWindow:{
                                  max:2000,
                                  min:0
                                  },
                      gridlines: {color: 'transparent'},
                      },
                  },
                  series: {0: {targetAxisIndex:1},
                   1:{targetAxisIndex:1},
                  },
      };

    function resize() {
      var chart = new google.visualization.LineChart(document.getElementById('14_day_chart'));
      chart.draw(view, options);
    }

    window.onload = resize();
    window.onresize = resize;

  });
}


</script>

<style>
body,h1,h2,h3,h4,h5 {font-family: "Raleway", sans-serif}
</style>
<body class="w3-light-grey">

<!-- w3-content defines a container for fixed size centered content, 
and is wrapped around the whole page content, except for the footer in this example -->
<div class="w3-content" style="max-width:1400px">

<!-- Header -->
<header class="w3-container w3-center w3-padding-32"> 
  <h1><b>Tracking COVID-19 in Pennsylvania</b></h1>
  <p>Created by <span class="w3-tag"><a style="color:blue" href="https://www.linkedin.com/in/david-miron/">David Miron</a></span></p>
  <center><h5>Page last updated on, <span class="w3-opacity">May 8, 2020</span></h5></center>
  <h4 style="color:DodgerBlue"><b><center> <a href="https://pa-covid19.com/charts">Charts</a> <br> <a href="https://www.governor.pa.gov/process-to-reopen-pennsylvania/">Process to Reopen Pennsylvania</a> <br> Hospital Data: <a href="https://www.arcgis.com/apps/opsdashboard/index.html#/85054b06472e4208b02285b8557f24cf">Desktop</a>
        <a href="https://www.arcgis.com/apps/opsdashboard/index.html#/00bd7d163117479c84da5405f25e2cdb">Mobile</a> </center></b></h4>
</header>

<!-- Grid -->
<div class="w3-row">
      
<!-- Blog entries -->
<div class="w3-col l8 s12">
  <!-- Blog entry -->
  <div class="w3-card-4 w3-margin w3-white">
    <!-- <img src="/w3images/woods.jpg" alt="Nature" style="width:100%"> -->
  </div>

<div class="w3-card-4 w3-margin w3-white">
    <div class="w3-container">
  <div id="piechart2"></div>
  <div class="w3-container">

      <p>
        This chart shows the number of new cases in Montgomery and Philadelphia County over the last 14 days.
        <br> <strong style="color:Red"><b>NOTE: MontCo Numbers on the left axis, and Philly on the right.</b></strong>
      </p>
      <p>
        This chart is motivated by the state's guidance that counties "having fewer than 50 new confirmed cases per 100,000 population reported to the department in the previous 14 days" will be able to begin the return to normal lifestyle. 
      </p>

      <p>
      The "goal" line will show where we need to get for these counties to re-open.
      </p>
  </div> 
    </div>
  </div>


<!-- Footer -->
<footer class="w3-container w3-dark-grey w3-padding-32 w3-margin-top">
  <!-- <button class="w3-button w3-black w3-disabled w3-padding-large w3-margin-bottom">Previous</button>
  <button class="w3-button w3-black w3-padding-large w3-margin-bottom">Next Â»</button> -->
  <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>
</footer>

</body>
</html>
